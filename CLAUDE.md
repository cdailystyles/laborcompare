# LaborCompare — Claude Code Instructions

## Git Workflow
- **Always pull before working**: `git pull origin main` at the start of every session
- **Always push when done**: Stage, commit, and push all changes after completing work
- Never force push. Never amend published commits.

## Project Overview
Static SPA (no build step) at `laborcompare.com` — a user-friendly BLS.gov alternative.
Deployed via GitHub Pages; changes go live immediately on push to main.

## Tech Stack
- Vanilla HTML/CSS/JS (no frameworks, no build tools)
- Leaflet.js 1.9.4 for maps (CartoDB Positron light tiles)
- Google Fonts: Space Grotesk + Inter
- No Node.js or Python available locally — scripts run via GitHub Actions only

## Architecture
- Hash-based SPA router (`js/router.js`)
- Routes: `#/`, `#/wages`, `#/wages/:soc`, `#/jobs`, `#/prices`, `#/states`, `#/states/:fips`, `#/outlook`, `#/map`, `#/compare`
- Legacy redirects: `/occupation/:soc` → `/wages/:soc`, `/area/:fips` → `/states/:fips`
- Data loaders: `js/loaders/oews-loader.js` (wages), `js/loaders/bls-loader.js` (CPI/JOLTS/projections)
- All data in `data/` as static JSON files

## Design System (F3 Dense Data-First)
- Light theme: bg #f7f7f8, surface #ffffff, accent #dc2626 (red)
- Black topbar ticker, compact stat cards, 4-column data grids
- Brutalist hover effects (box-shadow: 2px 2px 0)
- Mockup source of truth: `mockups/concept-f3-dense-data.html`

## Version Convention
Format: `YYYY.MM.DD.N` (N starts at 1 per day)
Located in: `index.html` footer `.ftr-version` + Sources modal `.source-disclaimer`

## Data Pipeline Status
- **Live**: OEWS wages (830+ occupations × states/metros)
- **Scripts ready**: CPI, JOLTS, employment projections (scripts created, need GitHub Actions run)
- **ticker.json**: Hardcoded stats; auto-generated by `process-ticker.js` when pipeline runs
- Pipeline scripts in `scripts/`, run via `.github/workflows/update-data.yml`
- New pipelines: `fetch-bls-cpi.js`, `fetch-bls-jolts.js`, `fetch-bls-projections.js`
- Processors: `process-cpi.js`, `process-jolts.js`, `process-projections.js`, `process-ticker.js`

## Rewrite Progress
- [x] Phase 1: Foundation (CSS, HTML shell, home page, app.js, new routes)
- [x] Phase 2: Page rewrites (wages.js, states.js, map-explorer, compare — all done)
- [x] Phase 3: New data pipelines (all fetch + process scripts created, workflow updated)
- [ ] Phase 4: New pages with real data (prices, jobs, outlook — need pipeline run first)
- [x] Phase 5: Cleanup (legacy files deleted, polish in progress)
